@model List<EntityLayer.Concrete.Reservation>
@using System.ComponentModel.DataAnnotations
@using System.Reflection

@{
    ViewData["Title"] = "MyOldReservations";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

<h3>Geçmiş Rezervasyonlarım</h3>

@functions {
    public string GetStatusClass(EntityLayer.Concrete.ReservationStatus status)
    {
        return status switch
        {
            EntityLayer.Concrete.ReservationStatus.Past => "text-warning",
            _ => "text-dark"
        };
    }
}

<table class="table table-bordered mt-3">
    <thead>
        <tr>
            <th>Destinasyon</th>
            <th>Kişi Sayısı</th>
            <th>Tarih</th>
            <th>Durum</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var res in Model)
        {
            <tr class="@((res.Status == EntityLayer.Concrete.ReservationStatus.Past) ? "" : "table-secondary")">
                <td>@res.Destination.City</td>
                <td>@res.PersonCount</td>
                <td>@res.ReservationDate.ToString("dd.MM.yyyy")</td>
                <td>
                    @{
                        var field = res.Status.GetType().GetField(res.Status.ToString());
                        var display = field.GetCustomAttribute<DisplayAttribute>()?.Name ?? res.Status.ToString();

                        var badgeClass = res.Status switch
                        {
                            EntityLayer.Concrete.ReservationStatus.Past => "badge bg-dark",
                            _ => "badge bg-light text-dark"
                        };
                    }
                    <span class="@badgeClass">@display</span>
                </td>
            </tr>
        }
    </tbody>
</table>
<a href="/Member/Reservation/MyReservations/" class="btn btn-outline-primary mt-2">Aktİf Rezervasyonlarım</a>
